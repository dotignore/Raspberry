=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
Owners			Owners (Name)
Manufacturer		Manufacturer (Name)
VehicleType		VehicleType (Name)
Models			Models ( ManufacturerID, VehicleTypeID, Name, MSRP )
Vehicles		Vehicles( OwnerID, ModelID, Mileage, LastService, PurchaseDate, PurchasePrice)

/* Owners (Name) */
/* 	    VARCHAR */
/* Manufacturer (Name) */
/* 		 VARCHAR */
/* VehicleType (Name) */
/* 		VARCHAR */
/* Models ( ManufacturerID, VehicleTypeID, Name, 	MSRP ) */
/* 		INT		INT	  VARCHAR	MONEY */
/* Vehicles( OwnerID, ModelID, Mileage, LastService, PurchaseDate, PurchasePrice) */
/* 		INT	INT	INT	 DATETIME	DATETIME	MONEY */

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
How many vehicle models per manufacturer? Как много моделей авто у производителей


By type
SELECT 
    Manufacturer.Name, Models.Name
FROM 
	Models, Manufacturer
WHERE 	    
	    Models.ManufacturerID = Manufacturer.ID

Total numbers
SELECT 
    Manufacturer.Name, COUNT(Models.ManufacturerID)
FROM 
	Models, Manufacturer
WHERE 	    
	    Models.ManufacturerID = Manufacturer.ID 
GROUP BY
    Manufacturer.Name
----------------------------------------------

Per Vehicle Type? 	По типу транспортного средства
SELECT Name FROM VehicleType;
----------------------------------------------

How many cars does each owner possess? 		Сколько машин каждьій человек имеет

/* Vehicles( OwnerID, ModelID, Mileage, LastService, PurchaseDate, PurchasePrice) */
/* Owners (Name) */
/* Models ( ManufacturerID, VehicleTypeID, Name, MSRP ) */
/* Manufacturer (Name) */

SELECT 
     	Owners.Name, 
 	Models.ManufacturerID AS Manuf, 
	Manufacturer.Name as Brand, 
	Vehicles.ModelID, 
	Models.Name as Model
FROM 
	Vehicles, Owners, Models, Manufacturer
WHERE 	    
	Vehicles.ModelID = Models.ID AND
	Models.ManufacturerID = Manufacturer.ID  AND
    Vehicles.OwnerID = Owners.ID
ORDER BY
    Owners.Name



SELECT 
     Owners.Name, COUNT(Owners.Name) as Amount_Car
FROM 
	Vehicles, Owners, Models, Manufacturer
WHERE 	    
	Vehicles.ModelID = Models.ID AND
	Models.ManufacturerID = Manufacturer.ID  AND
    Vehicles.OwnerID = Owners.ID
GROUP BY
    Owners.Name
ORDER BY
    Amount_Car DESC, Owners.Name

---------------------------------------------

How many total miles are logged to each owner?	Какой общий пробег и длительность у каждого владельца авто

SELECT SYSDATETIMEOFFSET()
https://docs.microsoft.com/en-us/sql/t-sql/functions/cast-and-convert-transact-sql?view=sql-server-ver15
https://www.w3schools.com/SQL/func_sqlserver_convert.asp
SELECT DATEDIFF (day, '2010-10-07T23:43:00', '2011-10-08T01:23:00')



SELECT  Owners.Name, Vehicles.Mileage, Manufacturer.Name AS Brand , Models.Name AS Model,
        DATEDIFF(year, CONVERT(VARCHAR,Vehicles.PurchaseDate,101), CONVERT(VARCHAR,Vehicles.LastService,101)) as year
FROM 
	Vehicles, Owners, Models, Manufacturer
WHERE 	    
	Vehicles.OwnerID = Owners.ID AND
    Vehicles.ModelID = Models.ID AND
    Models.ManufacturerID = Manufacturer.ID
ORDER BY 
    Owners.Name


ANSWER

SELECT  Owners.ID, Owners.Name, SUM(Vehicles.Mileage) as SumOfMilage
FROM 
	Vehicles, Owners
WHERE 	    
	Vehicles.OwnerID = Owners.ID
GROUP BY Owners.ID,Owners.Name



SELECT  
    Owners.ID, Owners.Name, 
    SUM(Vehicles.Mileage) as SumOfMilage, 
    SUM(DATEDIFF(year, Vehicles.PurchaseDate, Vehicles.LastService)) AS YearsOfUsage
FROM 
	Vehicles, Owners
WHERE 	    
	Vehicles.OwnerID = Owners.ID
GROUP BY 
    Owners.ID,Owners.Name

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

Ok
select @@version as 'sql server version'